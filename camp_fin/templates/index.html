{% extends 'base.html' %}
{% load helpers %}
{% load staticfiles %}
{% block title %}
Keep an eye on money in New Mexico politics
{% endblock %}


{% block full_content %}
<div class="container">

    <div class='row'>
        <div class='col-sm-10'>
            <div class='jumbotron'>
                <p>Keep an eye on money in New Mexico politics</p>

                <form action='/search' method='GET'>
                    <div class="input-group input-group-lg">
                        <input type="text" class="form-control" placeholder="Search for names of candidates, committees and donors in New Mexico" name="term">
                        <input type='hidden' name='table_name' value='candidate' />
                        <input type='hidden' name='table_name' value='pac' />
                        <input type='hidden' name='table_name' value='treasurer' />
                        <input type='hidden' name='table_name' value='contribution' />
                        <input type='hidden' name='table_name' value='expenditure' />
                        <span class="input-group-btn">
                            <button class="btn btn-default" type="submit"><i class='fa fa-search'></i> Search</button>
                        </span>
                    </div>
                </form>
            </div>
        </div>
        <div class='col-sm-2 visible-lg-inline visible-md-inline'>
            <p class='text-center'>Brought to you by</p>
            <a href='http://nmindepth.com'><img src="{% static 'images/nmid-logo-square.jpg' %}" style='height:130px; padding-bottom: 5px;' class='img-responsive center-block' /></a>
        </div>
    </div>
    <div class='row'>
        <div class='col-sm-12'>

            <h2><a href='/donations/'><i class='fa fa-fw fa-dollar'></i> Largest donations</a></h2>
            <table class='table table-condensed'>
                <thead>
                    <tr>
                        <th>
                            Donor
                        </th>

                        <th>
                            Amount {{ sort_order|get_sort_icon|safe }}
                        </th>
                        <th>
                            Recipient
                        </th>
                        <th>
                            Date
                        </th>
                    </tr>
                </thead>
                <tbody>
                    {% for transaction in transaction_objects %}
                    <tr>
                        <td>
                            {{ transaction.full_name }}
                        </td>
                        <td class='no-wrap'>
                            <a href="{% url 'contribution-detail' transaction.id %}">
                            {{transaction.transaction_type|get_transaction_verb }} <strong>{{ transaction.amount|format_money }}</strong> to
                            </a>
                        </td>
                        <td>
                            {% if transaction.pac_slug %}
                              <a href="{% url 'committee-detail' transaction.pac_slug %}">{{ transaction.transaction_subject }}</a>
                            {% endif %}
                            {% if transaction.candidate_slug %}
                              <a href="{% url 'candidate-detail' transaction.candidate_slug %}">{{ transaction.transaction_subject }}</a>
                            {% endif %}
                        </td>
                        <td class='no-wrap'>
                            {{ transaction.received_date|date:"M j, Y" }}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>

            <h2><a href='/candidates/'><i class='fa fa-fw fa-user'></i> Top candidates</a></h2>
            <table class='table table-condensed'>
                <thead>
                    <tr>
                        <th>Rank</th>
                        <th>Candidate</th>
                        <th>Office</th>
                        <th>Committee</th>
                        <th class='text-right no-wrap'>Current balance {{ sort_order|get_sort_icon|safe }}</th>
                    </tr>
                </thead>
                <tbody>
                    {% for candidate in candidate_objects %}
                    <tr>
                        <td>{{ candidate.rank }}</td>
                        <td><a href="{% url 'candidate-detail' candidate.slug %}">{{ candidate.full_name }}</a></td>
                        <td>{{ candidate.office_name }} {{ candidate.office_type }}</td>
                        <td>{{ candidate.committee_name|default_if_none:"" }}</td>
                        <td class='text-right'>{{ candidate.closing_balance|format_money }}</td>
                    </tr>
                    {% endfor %}
                </tbody>

            </table>

            <h2><a href='/committees/'><i class='fa fa-fw fa-group'></i> Committees</a></h2>
            <table class='table table-condensed'>
                <thead>
                    <tr>
                        <th>Rank</th>
                        <th>PAC</th>
                        <th>Latest report</th>
                        <th class='text-right no-wrap'>Current balance {{ sort_order|get_sort_icon|safe }}</th>
                    </tr>
                </thead>
                <tbody>
                    {% for pac in pac_objects %}
                    <tr>
                        <td>{{ pac.rank }}</td>
                        <td><a href="{% url 'committee-detail' pac.slug %}">{{ pac.name }}</a></td>
                        <td>{{ pac.filing_date | date:'M j, Y'}}</td>
                        <td class='text-right'>{{ pac.closing_balance|format_money }}</td>
                    </tr>
                    {% endfor %}
                </tbody>

            </table>

            <h2><a href='/donations/'><i class='fa fa-fw fa-info-circle'></i> About</a></h2>
            <p><strong>New Mexico Campaign Finance</strong> is a tool by New Mexico In Depth for browsing political contributions in the state of New Mexico.</p>

            <p>The data comes from the New Mexcio Secretary of State. We built this site to give journalists, activists and citizens better access to and documentation for this data.</p>
        </div>
    </div>

</div>
{% endblock %}
